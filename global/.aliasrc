#!/bin/sh

# Coreutils and similar
alias sudo=doas
alias lsn='ls --color=never'
alias ls='TERM=st-256color ls --color=always'
alias lf='ls -F'
alias ll='lf -la'
alias lt='ls -t'
alias llt='lt -la'
alias grepn='grep --color=never'
alias grep='grep --color=always'
alias rgrep='grep -r'
alias bgrep='grep -I'
alias exa='exa --color=always'
alias ell='exa -la'
alias bat='bat --color always'
alias batl='bat -l lisp'
alias less='less -r'
alias les='less -F'
alias dus='du -sh'
alias sb=sbase-box
alias bb=busybox
alias ag='ag --color --depth -1'
alias agh='ag --hidden'
#alias rg='rg -S'
alias rgh='rg --hidden'
alias egrep='grep -E'
alias eg='egrep'
alias gt='/bin/time'
alias gtv='/bin/time -v'
alias diff='diff --color=always'

# Text Editors
alias nano='nano --rcfile=~/.nanorc'
alias nv=nvim
alias s=svim
alias gsv=gsvim
alias se=exs
alias emg=emacs
alias em='emacs -nw'
alias emc='emacsclient -nw'
alias gemc='emacsclient -c'
alias emd='emacs --daemon'
alias vis='TERM=st-256color vis'
alias rsv='doas svim'
alias rka='doas kak'
alias rvi='doas vis'
alias fvc="fe svim"
alias fv="fed svim"
alias fkc="fe kak"
alias fk="fed kak"

#System Commands
alias sns=sensors
alias lcs='loginctl suspend'
alias pacman='pacman --color=always'
alias upg='pacman -Syu'
alias rupg='doas pacman -Syu'
alias paru='paru --color=always'
alias pc=pcurses
alias pa=pacman
alias rb=reboot
alias po=poweroff
alias rrb='doas reboot'
alias rpo='doas poweroff'
alias tbg='top -b | egrep'
alias tbgm='top -b -e m | egrep'
alias tbgo='top -b -n 1 | egrep'
alias tbgh='top -b -n 1 -e m | egrep'
alias mu='mount -o rw,uid=$UID'
alias rmu='doas mount -o rw,uid=$UID,gid=$GID'
alias um=umount
alias rum='doas umount'
alias pbs='pacman -Ql | grep /bin/ | egrep'
alias wb='bins | grep'

# Settings
alias pm=pulsemixer
alias am=alsamixer
alias als='alias | grep'

# Tools
alias qc="qalc -s 'decimal comma off'"
alias lsf='ls -FA --color=never --dereference-command-line-symlink-to-dir'
alias fzf='fzf -m -e'
alias fzy='fzy -l 20'
alias fzc='echo $PATH | xargs -d ':' ls | grep -vE ':$' | fzy | sh -s'
alias tm=tmux
alias tma='tmux attach'
alias sa='screen attach'
alias bm='BEMENU_BACKEND=curses bemenu'
alias nnn='nnn -d'
alias xcc='xclip -i -selection clipboard'
alias xcp='xclip -o -selection clipboard'
alias myip="curl -s ipinfo.io/ip | sed 'a\\'"
alias edr='doas svim'
alias sal='source /etc/.aliasrc'
alias bal='bat /etc/.aliasrc'
alias de='dc -e'
alias plc='plocate'
alias plci='plocate -i'
alias rlc='plocate -r'
alias rlci='plocate -ir'
alias prr='prime-run'
alias prg='progress -M -W 1'
alias prgc='prg \
	-a ffmpeg -a ebook-convert -a pdfgrep\
	-a yt-dlp -a youtube-dl -a you-get \
	-a vifm -a tree -a mpv \
	-a wget -a curl -a aria2 \
	-a rm -a du -a dd \
	-a rar -a unrar \
	-a zstd -a zstdcat -a zstdgrep -a unzstd \
	-a agrep -a ag -a pcregrep \
	-a less -a tail -a tac \
	-a sed -a awk \
	-a diff \
	'

# Other
alias yv=youtube-viewer
alias mdl='yv -n -d --convert-to=mp3'
alias ytf='youtube-dl --list-formats'
alias pg='ping gnu.org'
alias pgs='ping -c 3 gnu.org'
#alias w1='watch -n 1 -d'
#alias w1c='watch -n 1 -d -c'
alias w1='wat 1'
alias w1c='watc 1'
alias ws='w1 sensors'
alias wsc='w1 "sensors | egrep -v \"^$\""'
alias wst='w1c "sensors | grep --color=always Â°"'

# Languages
alias scls='sbcl --script'
alias rscl='rlwrap sbcl'
alias rooc='rlwrap ocaml'
PYPY='pypy3'
PYPYP="/opt/$PYPY/bin"
alias ipp="$PYPYP/ipython"
alias ibp="$PYPYP/bpython"
alias ppip="$PYPYP/pip"
alias pypym="$PYPY -m"
alias jle='julia -e'
alias pyc='python -c'

# Functions

lh () {
	if [ -n "$1" ]
	then
		ls -t | sed "$1q"
	else
		ls -t | sed 12q
	fi
}

bins () {
	pacman -Ql $1 | egrep "`echo $PATH | sed 's/:/|/g'`"
}

cdc () {
	cd $1 && clear
}

cdl () {
	cdc $1 && ls
}

cdll () {
	cdc $1 && ll
}

llh () {
	ll $1 | head
}

maxe () {
	if [ -n "$2" ]
	then
		cmds="$2"
		prec="$1"
	else
		cmds="$1"
		prec=20
	fi
	str=`echo -n $cmds | sed -z 's/[^;$\n]$/\0;/'`
	maxima --very-quiet --batch-string="fpprec:$prec \$ fpprintprec:$prec \$ $str quit();" | \
	sed -z 's/load[^\n]*\n[^\n]*\n//g' | \
	egrep '^[ 	]|\$|b0$|]$'
}

gple () {
	gnuplot -e "plot '$1' w l;pause -1"
}

edt () {
	if [ -n "$2" ]
	then
		$1 $2
	else
		svim $1
	fi
}

eal () {
	edt $1 /etc/.aliasrc
}

eal () {
	edt $1 /etc/.aliasrc
}

evr () {
	edt $1 /etc/.varrc
}

fec () {
	if [ -n "$1" ]
	then
		edt="$1"
	else
		edt='vim'
	fi

	if [ -n "$2" ]
	then
		comm=$2
	else
		comm="`lsn | fzf`"
	fi

	$edt $comm
}

fe () {
	fec "$1" "find -type f | fzf"
}

fed () {
	fec "$1"
}

find_command ()
{
	if [ -n "$2" ]
	then
		DIR=$1
		PATTERN=${@:2}
	else
		DIR=.
		PATTERN=$@
	fi
	#find $DIR $SWITCH "$ALL$PATTERN$ALL" 2>/dev/null
	find $DIR -regextype posix-extended $SWITCH "$ALL$PATTERN$ALL" 2>/dev/null
}

fnd () {
	SWITCH='-name'
	ALL='*'
	find_command $@
}

fndi () {
	SWITCH='-iname'
	ALL='*'
	find_command $@
}

fnds () {
	SWITCH='-regex'
	ALL='.*'
	find_command $@
}

fndr () {
	SWITCH='-iregex'
	ALL='.*'
	find_command $@
}

fnde () {
	SWITCH='-name'
	ALL=''
	find_command $@
}

fndie () {
	SWITCH='-iname'
	ALL=''
	find_command $@
}

fndse () {
	SWITCH='-regex'
	ALL=''
	find_command $@
}

fndre () {
	SWITCH='-iregex'
	ALL=''
	find_command $@
}

hms () {
	help2man --no-discard-stderr "$@" | man -l -
}

hm () {
	help2man "$@" | man -l -
}

noerr ()
{
	$@ 2>/dev/null
}

silent ()
{
	noerr $@ >/dev/null
}

dis ()
{
	silent $@ &
	disown
}

wat ()
{
	#if [ -n "$1" ]
	if [ "$1" -gt 0 ] 2>/dev/null
	then
		WTIME=$1
		COMMAND=${@:2}
	else
		WTIME=1
		COMMAND=$@
	fi
	watch -n $WTIME -d $COMMAND
}

watc () {
	wat $1 -c ${@:2}
}
